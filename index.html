<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barbearia Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .elegant-font { font-family: 'Playfair Display', serif; }
        
        .elegant-divider {
            position: relative;
            text-align: center;
            margin: 2rem 0;
        }
        
        .elegant-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, rgba(251, 191, 36, 0.3), transparent);
        }
        
        .elegant-divider span {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 0 2rem;
            color: #f59e0b;
            font-size: 1.5rem;
        }
        
        .cart-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .service-card:hover {
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        .floating-cart {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
        }
        
        .cart-panel {
            position: fixed;
            top: 150px;
            right: 20px;
            width: 350px;
            max-height: 500px;
            z-index: 1001;
        }
        
        @media (max-width: 640px) {
            .cart-panel {
                width: calc(100vw - 40px);
                right: 20px;
                left: 20px;
            }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 350px;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        @media (max-width: 640px) {
            .toast {
                right: 20px;
                left: 20px;
                max-width: none;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen text-white">
    <!-- Toast Notifications -->
    <div id="toastContainer"></div>

    <!-- Floating Cart Icon -->
    <div class="floating-cart">
        <button id="cartToggle" class="bg-amber-500 hover:bg-amber-600 text-white p-3 rounded-full shadow-lg transition-all duration-300 relative">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h9M17 21a2 2 0 100-4 2 2 0 000 4zm-8 0a2 2 0 100-4 2 2 0 000 4z"></path>
            </svg>
            <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
        </button>
    </div>

    <!-- Cart Panel -->
    <div id="cartPanel" class="cart-panel bg-white text-gray-800 rounded-lg shadow-2xl hidden">
        <div class="p-4 border-b border-gray-200 flex justify-between items-center">
            <h3 class="font-semibold text-lg">Carrinho de Servi√ßos</h3>
            <button id="closeCart" class="text-gray-500 hover:text-gray-700" title="Fechar carrinho" aria-label="Fechar carrinho">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <div id="cartItems" class="p-4 max-h-60 overflow-y-auto">
            <p class="text-gray-500 text-center">Carrinho vazio</p>
        </div>
        <div class="p-4 border-t border-gray-200">
            <div class="flex justify-between items-center mb-3">
                <span class="font-semibold">Total:</span>
                <span id="cartTotal" class="font-bold text-lg text-amber-600">R$ 0,00</span>
            </div>
            <button id="proceedBooking" class="w-full bg-amber-500 hover:bg-amber-600 text-white py-2 px-4 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                Agendar Servi√ßos
            </button>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-black/20 backdrop-blur-sm border-b border-white/10 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <img id="barbershopLogo" src="https://images.unsplash.com/photo-1585747860715-2ba37e788b70?w=50&h=50&fit=crop&crop=center" 
                         alt="Logo da Barbearia" class="w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border-2 border-amber-400 flex-shrink-0 shadow-lg">
                    <h1 id="barbershopName" class="text-lg sm:text-2xl font-bold text-amber-400 truncate">Barbearia Premium</h1>
                </div>
                <!-- Desktop Menu -->
                <div class="hidden sm:flex space-x-6">
                    <button onclick="showPage('home')" class="nav-btn text-white hover:text-amber-400 transition-colors">In√≠cio</button>
                    <button onclick="showPage('booking')" class="nav-btn text-white hover:text-amber-400 transition-colors">Agendar</button>
                    <button onclick="showAdminLogin()" class="nav-btn text-white hover:text-amber-400 transition-colors">Admin</button>
                    <button id="logoutBtn" onclick="logout()" class="nav-btn text-red-400 hover:text-red-600 transition-colors hidden">Sair</button>
                </div>
                
                <!-- Mobile Menu Button -->
                <button id="mobileMenuBtn" onclick="toggleMobileMenu()" class="sm:hidden p-2 text-white hover:text-amber-400 transition-colors">
                    <svg id="hamburgerIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                    <svg id="closeIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu Dropdown -->
        <div id="mobileMenu" class="sm:hidden bg-black/30 backdrop-blur-sm border-t border-white/10 hidden">
            <div class="container mx-auto px-4 py-4 space-y-2">
                <button onclick="showPage('home'); closeMobileMenu()" class="block w-full text-left py-3 px-4 text-white hover:text-amber-400 hover:bg-white/10 rounded-lg transition-colors">
                    üè† In√≠cio
                </button>
                <button onclick="showPage('booking'); closeMobileMenu()" class="block w-full text-left py-3 px-4 text-white hover:text-amber-400 hover:bg-white/10 rounded-lg transition-colors">
                    üìÖ Agendar
                </button>
                <button onclick="showAdminLogin(); closeMobileMenu()" class="block w-full text-left py-3 px-4 text-white hover:text-amber-400 hover:bg-white/10 rounded-lg transition-colors">
                    ‚öôÔ∏è Admin
                </button>
                <button id="mobileLogoutBtn" onclick="logout(); closeMobileMenu()" class="block w-full text-left py-3 px-4 text-red-400 hover:text-red-600 hover:bg-red-500/10 rounded-lg transition-colors hidden">
                    üö™ Sair
                </button>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <div id="homePage" class="page">
        <!-- Owner Profile Section -->
        <section class="container mx-auto px-4 py-8">
            <div class="text-center mb-8">
                <div class="mb-6">
                    <img id="ownerPhoto" src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=face" 
                         alt="Foto do Propriet√°rio" class="w-32 h-32 rounded-full mx-auto object-cover border-4 border-amber-400 shadow-lg">
                </div>
                <h2 class="elegant-font text-5xl font-bold mb-4 text-amber-100">Bem-vindo √† Nossa Barbearia</h2>
                <p id="barbershopDescription" class="text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed">Experi√™ncia premium em cortes e cuidados masculinos com mais de 10 anos de tradi√ß√£o</p>
            </div>
            
            <!-- Elegant Divider -->
            <div class="elegant-divider">
                <span class="elegant-font">‚úÇ</span>
            </div>
        </section>

        <!-- Services Section -->
        <section class="container mx-auto px-4 py-4">
            <h3 class="elegant-font text-4xl font-bold text-center mb-12 text-amber-100">Nossos Servi√ßos</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8" id="servicesGrid">
                <!-- Services will be populated by JavaScript -->
            </div>
        </section>

        <!-- Contact Section -->
        <section class="container mx-auto px-4 py-12">
            <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-center">
                <h3 class="elegant-font text-3xl font-bold mb-6 text-amber-100">Entre em Contato</h3>
                <div class="grid md:grid-cols-2 gap-6 text-left max-w-2xl mx-auto">
                    <div class="flex items-center space-x-3">
                        <div class="bg-amber-500/20 p-3 rounded-full">
                            <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-gray-400 text-sm">Telefone</p>
                            <p id="contactPhone" class="text-amber-400 font-semibold">(11) 99999-9999</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <div class="bg-amber-500/20 p-3 rounded-full">
                            <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-gray-400 text-sm">Email</p>
                            <p id="contactEmail" class="text-amber-400 font-semibold">contato@barbearia.com</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <div class="bg-amber-500/20 p-3 rounded-full">
                            <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-gray-400 text-sm">Endere√ßo</p>
                            <p id="contactAddress" class="text-amber-400 font-semibold">Rua das Flores, 123 - Centro</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <div class="bg-amber-500/20 p-3 rounded-full">
                            <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-gray-400 text-sm">Hor√°rio</p>
                            <p id="contactWorkingHours" class="text-amber-400 font-semibold">Segunda a S√°bado, 9h √†s 19h</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Booking Page -->
    <div id="bookingPage" class="page hidden">
        <div class="container mx-auto px-4 py-12">
            <h2 class="text-3xl font-bold text-center mb-12">Agendar Hor√°rio</h2>
            
            <div class="max-w-2xl mx-auto bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                <form id="bookingForm">
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nome Completo</label>
                            <input type="text" id="clientName" required class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Seu nome completo">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="clientEmail" required class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="seu@email.com">
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Selecionar Data</label>
                        <div class="bg-white/10 rounded-lg p-4">
                            <!-- Week Navigation -->
                            <div class="flex justify-between items-center mb-4">
                                <button type="button" id="prevWeek" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors" title="Semana anterior" aria-label="Semana anterior">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                </button>
                                <h3 id="weekTitle" class="text-lg font-semibold text-center"></h3>
                                <button type="button" id="nextWeek" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors" title="Pr√≥xima semana" aria-label="Pr√≥xima semana">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </button>
                            </div>
                            <!-- Week Days -->
                            <div id="weekDays" class="grid grid-cols-7 gap-1 sm:gap-2">
                                <!-- Week days will be populated by JavaScript -->
                            </div>
                        </div>
                        <input type="hidden" id="selectedDate" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Hor√°rios Dispon√≠veis</label>
                        <div id="timeSlots" class="grid grid-cols-3 gap-3">
                            <!-- Time slots will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full bg-amber-500 hover:bg-amber-600 text-white py-3 px-6 rounded-lg font-medium transition-colors">
                        Confirmar Agendamento
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Login Page -->
    <div id="adminLoginPage" class="page hidden">
        <div class="container mx-auto px-4 py-12">
            <div class="max-w-md mx-auto bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                <h2 class="text-2xl font-bold text-center mb-8">Acesso Administrativo</h2>
                <form id="adminLoginForm">
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Usu√°rio</label>
                        <input type="text" id="adminUsername" required class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Digite o usu√°rio">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Senha</label>
                        <input type="password" id="adminPassword" required class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Digite a senha">
                    </div>
                    <button type="submit" class="w-full bg-amber-500 hover:bg-amber-600 text-white py-3 px-6 rounded-lg font-medium transition-colors">
                        Entrar
                    </button>
                </form>
                <div id="loginError" class="mt-4 text-red-400 text-center hidden">
                    Usu√°rio ou senha incorretos!
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Page -->
    <div id="adminPage" class="page hidden">
        <div class="container mx-auto px-4 py-12">
            <h2 class="text-3xl font-bold text-center mb-12">Painel Administrativo</h2>
            
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Admin Header -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 mb-8">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center space-x-4">
                            <span class="text-green-400">‚úì Logado como Admin</span>
                        </div>
                        <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                            Sair
                        </button>
                    </div>
                </div>

                <!-- Barbershop Settings -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <h3 class="text-xl font-bold mb-6">Configura√ß√µes da Barbearia</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nome da Barbearia</label>
                            <input type="text" id="adminBarbershopName" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Telefone de Contato</label>
                            <input type="tel" id="adminPhone" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email de Contato</label>
                            <input type="email" id="adminEmail" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="contato@barbearia.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Endere√ßo</label>
                            <input type="text" id="adminAddress" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Rua das Flores, 123 - Centro">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Hor√°rio de Funcionamento</label>
                            <input type="text" id="adminWorkingHours" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Segunda a S√°bado, 9h √†s 19h">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">URL da Logo da Barbearia</label>
                            <input type="url" id="adminBarbershopLogo" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="https://exemplo.com/logo.jpg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">URL da Foto do Propriet√°rio</label>
                            <input type="url" id="adminOwnerPhoto" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="https://exemplo.com/foto.jpg">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Descri√ß√£o da Barbearia</label>
                            <textarea id="adminDescription" rows="3" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400 resize-none" placeholder="Digite a descri√ß√£o da sua barbearia..."></textarea>
                        </div>
                    </div>
                    <button onclick="saveSettings()" class="mt-4 bg-green-500 hover:bg-green-600 text-white py-2 px-6 rounded-lg font-medium transition-colors">
                        Salvar Configura√ß√µes
                    </button>
                </div>

                <!-- Services Management -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Gerenciar Servi√ßos</h3>
                        <button onclick="showAddServiceForm()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            + Adicionar Servi√ßo
                        </button>
                    </div>
                    
                    <!-- Add/Edit Service Form -->
                    <div id="serviceForm" class="hidden mb-6 p-4 bg-white/5 rounded-lg border border-white/20">
                        <h4 id="serviceFormTitle" class="text-lg font-semibold mb-4">Adicionar Novo Servi√ßo</h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Nome do Servi√ßo</label>
                                <input type="text" id="serviceName" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Ex: Corte Tradicional">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Pre√ßo (R$)</label>
                                <input type="number" id="servicePrice" min="0" step="0.01" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="25.00">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Dura√ß√£o (minutos)</label>
                                <select id="serviceDuration" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    <option value="30">30 minutos</option>
                                    <option value="60">1 hora</option>
                                    <option value="90">1h 30min</option>
                                    <option value="120">2 horas</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium mb-2">Descri√ß√£o</label>
                                <textarea id="serviceDescription" rows="2" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400 resize-none" placeholder="Descri√ß√£o do servi√ßo..."></textarea>
                            </div>
                        </div>
                        <div class="flex space-x-3 mt-4">
                            <button onclick="saveService()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                Salvar Servi√ßo
                            </button>
                            <button onclick="cancelServiceForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                Cancelar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Services List -->
                    <div id="servicesList" class="space-y-3">
                        <!-- Services will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Schedule Management -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <h3 class="text-xl font-bold mb-6">Gerenciar Hor√°rios de Funcionamento</h3>
                    
                    <!-- Hor√°rios Padr√£o -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4">Configurar Hor√°rios Padr√£o</h4>
                        <div class="grid grid-cols-1 gap-4">
                            <!-- Segunda-feira -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="monday" onchange="toggleDay('monday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Segunda-feira</span>
                                    </label>
                                </div>
                                <div id="mondayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="mondayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="mondayEnd" value="18:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- Ter√ßa-feira -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="tuesday" onchange="toggleDay('tuesday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Ter√ßa-feira</span>
                                    </label>
                                </div>
                                <div id="tuesdayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="tuesdayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="tuesdayEnd" value="18:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- Quarta-feira -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="wednesday" onchange="toggleDay('wednesday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Quarta-feira</span>
                                    </label>
                                </div>
                                <div id="wednesdayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="wednesdayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="wednesdayEnd" value="18:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- Quinta-feira -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="thursday" onchange="toggleDay('thursday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Quinta-feira</span>
                                    </label>
                                </div>
                                <div id="thursdayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="thursdayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="thursdayEnd" value="18:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- Sexta-feira -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="friday" onchange="toggleDay('friday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Sexta-feira</span>
                                    </label>
                                </div>
                                <div id="fridayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="fridayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="fridayEnd" value="18:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- S√°bado -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="saturday" onchange="toggleDay('saturday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">S√°bado</span>
                                    </label>
                                </div>
                                <div id="saturdayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="saturdayStart" value="09:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="saturdayEnd" value="17:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>

                            <!-- Domingo -->
                            <div class="bg-white/5 p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="sunday" onchange="toggleDay('sunday')" class="w-5 h-5 text-amber-500 bg-white/20 border-white/30 rounded focus:ring-amber-400 focus:ring-2">
                                        <span class="text-lg font-medium">Domingo</span>
                                    </label>
                                </div>
                                <div id="sundayTimes" class="grid grid-cols-2 gap-4 hidden">
                                    <div>
                                        <label class="block text-sm mb-1">Abertura</label>
                                        <input type="time" id="sundayStart" value="10:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                    <div>
                                        <label class="block text-sm mb-1">Fechamento</label>
                                        <input type="time" id="sundayEnd" value="16:00" class="w-full px-3 py-2 bg-white/20 border border-white/30 rounded text-white focus:outline-none focus:ring-2 focus:ring-amber-400">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button onclick="saveScheduleSettings()" class="mt-6 bg-green-500 hover:bg-green-600 text-white py-2 px-6 rounded-lg font-medium transition-colors">
                            Salvar Hor√°rios de Funcionamento
                        </button>
                    </div>

                    <!-- Status dos Hor√°rios -->
                    <div class="mt-8">
                        <h4 class="text-lg font-semibold mb-4">Status Atual dos Hor√°rios</h4>
                        <div id="scheduleStatus" class="grid grid-cols-1 gap-2">
                            <!-- Status will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Security Settings -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <h3 class="text-xl font-bold mb-6">Configura√ß√µes de Seguran√ßa</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nova Senha de Admin</label>
                            <input type="password" id="newAdminPassword" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Digite a nova senha">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Confirmar Nova Senha</label>
                            <input type="password" id="confirmAdminPassword" class="w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Confirme a nova senha">
                        </div>
                    </div>
                    <button onclick="changeAdminPassword()" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-6 rounded-lg font-medium transition-colors">
                        Alterar Senha
                    </button>
                </div>

                <!-- Financial Reports -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4">
                        <h3 class="text-xl font-bold">üìä Relat√≥rios Financeiros</h3>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="generateSampleData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                üìà Gerar Dados Exemplo
                            </button>
                            <button onclick="exportToCSV()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                üìÑ Exportar CSV
                            </button>
                            <button onclick="exportToPDF()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                üìë Exportar PDF
                            </button>
                            <button onclick="clearReportsData()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                üóëÔ∏è Limpar Dados
                            </button>
                        </div>
                    </div>
                    
                    <!-- M√©tricas Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <div class="bg-gradient-to-r from-green-500/20 to-green-600/20 p-4 rounded-lg border border-green-500/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-green-300 text-sm font-medium">Receita Total</p>
                                    <p id="totalRevenue" class="text-2xl font-bold text-green-400">R$ 0,00</p>
                                </div>
                                <div class="bg-green-500/30 p-3 rounded-full">
                                    <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-500/20 to-blue-600/20 p-4 rounded-lg border border-blue-500/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-blue-300 text-sm font-medium">Agendamentos</p>
                                    <p id="totalBookings" class="text-2xl font-bold text-blue-400">0</p>
                                </div>
                                <div class="bg-blue-500/30 p-3 rounded-full">
                                    <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-amber-500/20 to-amber-600/20 p-4 rounded-lg border border-amber-500/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-amber-300 text-sm font-medium">Ticket M√©dio</p>
                                    <p id="averageTicket" class="text-2xl font-bold text-amber-400">R$ 0,00</p>
                                </div>
                                <div class="bg-amber-500/30 p-3 rounded-full">
                                    <svg class="w-6 h-6 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-500/20 to-purple-600/20 p-4 rounded-lg border border-purple-500/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-300 text-sm font-medium">Este M√™s</p>
                                    <p id="monthlyRevenue" class="text-2xl font-bold text-purple-400">R$ 0,00</p>
                                </div>
                                <div class="bg-purple-500/30 p-3 rounded-full">
                                    <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gr√°ficos -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Receita por M√™s -->
                        <div class="bg-white/5 p-6 rounded-lg border border-white/20">
                            <h4 class="text-lg font-semibold mb-4 text-center">üìà Receita por M√™s</h4>
                            <div id="monthlyChart" class="h-64 flex items-end justify-center space-x-2">
                                <!-- Chart will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Servi√ßos Mais Populares -->
                        <div class="bg-white/5 p-6 rounded-lg border border-white/20">
                            <h4 class="text-lg font-semibold mb-4 text-center">üèÜ Servi√ßos Mais Populares</h4>
                            <div id="servicesChart" class="space-y-3">
                                <!-- Chart will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bookings Management -->
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4">
                        <h3 class="text-xl font-bold">üìÖ Gerenciar Agendamentos</h3>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="showPendingBookings()" class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                Pendentes (<span id="pendingCount">0</span>)
                            </button>
                            <button onclick="showCompletedBookings()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                Conclu√≠dos (<span id="completedCount">0</span>)
                            </button>
                            <button onclick="showAllBookings()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                Todos
                            </button>
                        </div>
                    </div>
                    
                    <div id="bookingsContainer" class="space-y-3">
                        <!-- Bookings will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-black/30 backdrop-blur-sm border-t border-white/10 mt-16">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center">
                <div class="mb-4">
                    <h3 class="text-xl font-bold text-amber-400 mb-2">Barbearia Premium</h3>
                    <p class="text-gray-300 text-sm">Experi√™ncia premium em cortes e cuidados masculinos</p>
                </div>
                
                <div class="border-t border-white/10 pt-4">
                    <p class="text-gray-400 text-sm">
                        ¬© 2024 Todos os direitos reservados | 
                        <span class="text-amber-400 font-medium">Desenvolvido por Inovar Automa√ß√µes</span>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ===== SISTEMA DE PERSIST√äNCIA DE DADOS =====
        
        // Fun√ß√µes para salvar e carregar dados do localStorage
        function saveToStorage(key, data) {
            try {
                localStorage.setItem(`barbearia_${key}`, JSON.stringify(data));
            } catch (error) {
                console.warn('Erro ao salvar dados:', error);
            }
        }
        
        function loadFromStorage(key, defaultValue) {
            try {
                const stored = localStorage.getItem(`barbearia_${key}`);
                return stored ? JSON.parse(stored) : defaultValue;
            } catch (error) {
                console.warn('Erro ao carregar dados:', error);
                return defaultValue;
            }
        }
        
        // Global state com dados persistentes
        let cart = [];
        let services = loadFromStorage('services', [
            { id: 1, name: 'Corte Tradicional', price: 25, description: 'Corte cl√°ssico com acabamento perfeito', duration: 30, available: true },
            { id: 2, name: 'Barba Completa', price: 20, description: 'Aparar e modelar barba com navalha', duration: 30, available: true },
            { id: 3, name: 'Corte + Barba', price: 40, description: 'Combo completo de corte e barba', duration: 60, available: true },
            { id: 4, name: 'Sobrancelha', price: 15, description: 'Design e limpeza das sobrancelhas', duration: 30, available: true },
            { id: 5, name: 'Lavagem + Hidrata√ß√£o', price: 30, description: 'Tratamento completo para cabelos', duration: 30, available: true },
            { id: 6, name: 'Corte Infantil', price: 20, description: 'Corte especial para crian√ßas at√© 12 anos', duration: 30, available: true }
        ]);
        let schedules = loadFromStorage('schedules', []);
        let bookings = loadFromStorage('bookings', []);
        let settings = loadFromStorage('settings', {
            barbershopName: 'Barbearia Premium',
            phone: '(11) 99999-9999',
            email: 'contato@barbearia.com',
            address: 'Rua das Flores, 123 - Centro',
            workingHours: 'Segunda a S√°bado, 9h √†s 19h',
            logo: 'https://images.unsplash.com/photo-1585747860715-2ba37e788b70?w=50&h=50&fit=crop&crop=center',
            ownerPhoto: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=face',
            description: 'Experi√™ncia premium em cortes e cuidados masculinos com mais de 10 anos de tradi√ß√£o'
        });
        
        // Admin authentication com persist√™ncia
        let isAdminLoggedIn = false;
        let adminCredentials = loadFromStorage('adminCredentials', {
            username: 'admin',
            password: 'barbearia123'
        });

        // Toast notification function
        function showToast(message, type = 'success') {
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast bg-white text-gray-800 rounded-lg shadow-lg p-4 mb-3 flex items-center space-x-3`;
            
            const icon = type === 'success' ? 
                '<svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>' :
                '<svg class="w-5 h-5 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>';
            
            toast.innerHTML = `
                ${icon}
                <span class="flex-1 text-sm font-medium">${message}</span>
                <button onclick="this.parentElement.remove()" class="text-gray-400 hover:text-gray-600" title="Fechar notifica√ß√£o" aria-label="Fechar notifica√ß√£o">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            `;
            
            toastContainer.appendChild(toast);
            
            // Show toast with animation
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            renderServices();
            
            // Gerar hor√°rios automaticamente se n√£o existirem ou se est√£o desatualizados
            if (schedules.length === 0 || shouldRegenerateSchedules()) {
                generateSchedulesFromWeekly();
            }
            
            // Inicializar o calend√°rio ap√≥s gerar os hor√°rios
            renderWeekView();
            
            updateScheduleStatus();
            renderServicesList();
            renderBookings(); // Inicializar agendamentos
            updateReports(); // Inicializar relat√≥rios

            loadWeeklyScheduleUI(); // Carregar configura√ß√µes de hor√°rios na interface
            
            // Cart functionality
            document.getElementById('cartToggle').addEventListener('click', toggleCart);
            document.getElementById('closeCart').addEventListener('click', closeCart);
            document.getElementById('proceedBooking').addEventListener('click', proceedToBooking);
            
            // Booking form
            document.getElementById('bookingForm').addEventListener('submit', handleBooking);
            
            // Admin login form
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            
            // Week navigation
            document.getElementById('prevWeek').addEventListener('click', () => navigateWeek(-1));
            document.getElementById('nextWeek').addEventListener('click', () => navigateWeek(1));
            

        });

        // ===== FUN√á√ïES GLOBAIS PARA ONCLICK =====
        // Garantir que todas as fun√ß√µes chamadas via onclick estejam no escopo global

        // Page navigation
        window.showPage = function(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId + 'Page').classList.remove('hidden');
        }

        // Admin authentication functions
        window.showAdminLogin = function() {
            if (isAdminLoggedIn) {
                showPage('admin');
            } else {
                showPage('adminLogin');
            }
        }

        window.logout = function() {
            isAdminLoggedIn = false;
            updateAdminUI();
            showPage('home');
        }

        // Cart functionality
        window.addToCart = function(serviceId) {
            const service = services.find(s => s.id === serviceId);
            
            if (!service || !service.available) {
                showToast('Este servi√ßo n√£o est√° dispon√≠vel no momento.', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.id === serviceId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...service, quantity: 1 });
            }
            
            updateCartDisplay();
        }

        window.removeFromCart = function(serviceId) {
            cart = cart.filter(item => item.id !== serviceId);
            updateCartDisplay();
        }

        // Date selection
        window.selectDate = function(dateStr) {
            selectedDateValue = dateStr;
            document.getElementById('selectedDate').value = dateStr;
            
            // Update visual selection
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.remove('bg-amber-400', 'border-amber-400', 'bg-amber-400/30');
                btn.classList.add('border-white/20');
            });
            
            // Encontrar o bot√£o clicado e destac√°-lo
            const clickedBtn = event.target.closest('.date-btn');
            if (clickedBtn) {
                clickedBtn.classList.remove('border-white/20');
                clickedBtn.classList.add('bg-amber-400', 'border-amber-400');
            }
            
            // Load time slots for selected date
            loadTimeSlots();
        }

        window.selectTimeSlot = function(time) {
            selectedTime = time;
            document.querySelectorAll('.time-slot').forEach(btn => {
                btn.classList.remove('border-amber-400', 'bg-amber-400/20');
                btn.classList.add('border-white/30');
            });
            
            // Encontrar o bot√£o clicado e destac√°-lo
            const clickedBtn = event.target.closest('.time-slot');
            if (clickedBtn) {
                clickedBtn.classList.remove('border-white/30');
                clickedBtn.classList.add('border-amber-400', 'bg-amber-400/20');
            }
        }

        // Configura√ß√µes de hor√°rios padr√£o com persist√™ncia
        let weeklySchedule = loadFromStorage('weeklySchedule', {
            monday: { enabled: true, start: '09:00', end: '18:00' },
            tuesday: { enabled: true, start: '09:00', end: '18:00' },
            wednesday: { enabled: true, start: '09:00', end: '18:00' },
            thursday: { enabled: true, start: '09:00', end: '18:00' },
            friday: { enabled: true, start: '09:00', end: '18:00' },
            saturday: { enabled: true, start: '09:00', end: '18:00' },
            sunday: { enabled: false, start: '10:00', end: '16:00' }
        });

        // Fun√ß√£o para carregar configura√ß√µes de hor√°rios na interface
        function loadWeeklyScheduleUI() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            
            days.forEach(day => {
                const checkbox = document.getElementById(day);
                const timesDiv = document.getElementById(day + 'Times');
                const startInput = document.getElementById(day + 'Start');
                const endInput = document.getElementById(day + 'End');
                
                if (weeklySchedule[day].enabled) {
                    checkbox.checked = true;
                    timesDiv.classList.remove('hidden');
                } else {
                    checkbox.checked = false;
                    timesDiv.classList.add('hidden');
                }
                
                startInput.value = weeklySchedule[day].start;
                endInput.value = weeklySchedule[day].end;
            });
        }

        // Fun√ß√£o para alternar dia da semana
        window.toggleDay = function(day) {
            const checkbox = document.getElementById(day);
            const timesDiv = document.getElementById(day + 'Times');
            
            if (checkbox.checked) {
                timesDiv.classList.remove('hidden');
                weeklySchedule[day].enabled = true;
            } else {
                timesDiv.classList.add('hidden');
                weeklySchedule[day].enabled = false;
            }
            
            saveToStorage('weeklySchedule', weeklySchedule);
            updateScheduleStatus();
        }

        // Fun√ß√£o para alternar disponibilidade do servi√ßo
        window.toggleServiceAvailability = function(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.available = !service.available;
                
                // Salvar no localStorage
                saveToStorage('services', services);
                
                renderServices();
                renderServicesList();
                
                const status = service.available ? 'dispon√≠vel' : 'indispon√≠vel';
                showToast(`${service.name} agora est√° ${status}!`);
            }
        }

        // Salvar configura√ß√µes de hor√°rios
        window.saveScheduleSettings = function() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            
            days.forEach(day => {
                const checkbox = document.getElementById(day);
                const startTime = document.getElementById(day + 'Start').value;
                const endTime = document.getElementById(day + 'End').value;
                
                if (checkbox.checked) {
                    if (startTime >= endTime) {
                        showToast(`Hor√°rio inv√°lido para ${getDayName(day)}. In√≠cio deve ser antes do fim.`, 'error');
                        return;
                    }
                    
                    weeklySchedule[day] = {
                        enabled: true,
                        start: startTime,
                        end: endTime
                    };
                } else {
                    weeklySchedule[day].enabled = false;
                }
            });
            
            // Salvar no localStorage
            saveToStorage('weeklySchedule', weeklySchedule);
            
            // Gerar hor√°rios para as pr√≥ximas 4 semanas baseado na configura√ß√£o
            generateSchedulesFromWeekly();
            updateScheduleStatus();
            showToast('Hor√°rios de funcionamento salvos com sucesso!');
        }

        // Verificar se os hor√°rios precisam ser regenerados
        function shouldRegenerateSchedules() {
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            
            // Verificar se h√° hor√°rios para hoje ou para o futuro
            const futureSchedules = schedules.filter(schedule => schedule.date >= todayStr);
            
            // Se n√£o h√° hor√°rios futuros, precisa regenerar
            if (futureSchedules.length === 0) {
                return true;
            }
            
            // Verificar se a configura√ß√£o semanal mudou
            const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);
            const tomorrowStr = tomorrow.toISOString().split('T')[0];
            const tomorrowDayName = dayNames[tomorrow.getDay()];
            const tomorrowConfig = weeklySchedule[tomorrowDayName];
            
            // Verificar se existe hor√°rio para amanh√£ quando deveria existir
            const tomorrowSchedule = schedules.find(s => s.date === tomorrowStr);
            
            if (tomorrowConfig.enabled && !tomorrowSchedule) {
                return true;
            }
            
            if (!tomorrowConfig.enabled && tomorrowSchedule) {
                return true;
            }
            
            return false;
        }

        // Gerar hor√°rios baseado na configura√ß√£o semanal
        function generateSchedulesFromWeekly() {
            console.log('Gerando hor√°rios baseados na configura√ß√£o semanal...');
            console.log('Configura√ß√£o semanal:', weeklySchedule);
            
            // Limpar hor√°rios existentes
            schedules.length = 0;
            
            const today = new Date();
            const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            
            // Gerar para as pr√≥ximas 4 semanas
            for (let week = 0; week < 4; week++) {
                for (let dayOffset = 0; dayOffset < 7; dayOffset++) {
                    const currentDate = new Date(today);
                    currentDate.setDate(today.getDate() + (week * 7) + dayOffset);
                    
                    const dayName = dayNames[currentDate.getDay()];
                    const dayConfig = weeklySchedule[dayName];
                    
                    // Verificar se o dia est√° habilitado e n√£o √© uma data passada
                    if (dayConfig && dayConfig.enabled && currentDate >= today) {
                        const schedule = {
                            id: Date.now() + Math.random(),
                            date: currentDate.toISOString().split('T')[0],
                            startTime: dayConfig.start,
                            endTime: dayConfig.end
                        };
                        
                        schedules.push(schedule);
                        console.log('Hor√°rio adicionado:', schedule);
                    }
                }
            }
            
            console.log('Total de hor√°rios gerados:', schedules.length);
            
            // Salvar os hor√°rios gerados no localStorage
            saveToStorage('schedules', schedules);
            
            // Recarregar hor√°rios se uma data estiver selecionada
            if (selectedDateValue) {
                loadTimeSlots();
            }
        }

        // Atualizar status dos hor√°rios
        function updateScheduleStatus() {
            const statusDiv = document.getElementById('scheduleStatus');
            const dayNames = {
                monday: 'Segunda-feira',
                tuesday: 'Ter√ßa-feira', 
                wednesday: 'Quarta-feira',
                thursday: 'Quinta-feira',
                friday: 'Sexta-feira',
                saturday: 'S√°bado',
                sunday: 'Domingo'
            };
            
            let statusHTML = '';
            
            Object.keys(weeklySchedule).forEach(day => {
                const config = weeklySchedule[day];
                const dayName = dayNames[day];
                
                if (config.enabled) {
                    statusHTML += `
                        <div class="flex justify-between items-center bg-green-500/20 border border-green-500/30 p-3 rounded-lg">
                            <span class="font-medium">${dayName}</span>
                            <span class="text-green-400">Aberto: ${config.start} - ${config.end}</span>
                        </div>
                    `;
                } else {
                    statusHTML += `
                        <div class="flex justify-between items-center bg-red-500/20 border border-red-500/30 p-3 rounded-lg">
                            <span class="font-medium">${dayName}</span>
                            <span class="text-red-400">Fechado</span>
                        </div>
                    `;
                }
            });
            
            statusDiv.innerHTML = statusHTML;
        }

        function getDayName(day) {
            const names = {
                monday: 'Segunda-feira',
                tuesday: 'Ter√ßa-feira',
                wednesday: 'Quarta-feira', 
                thursday: 'Quinta-feira',
                friday: 'Sexta-feira',
                saturday: 'S√°bado',
                sunday: 'Domingo'
            };
            return names[day];
        }

        window.saveSettings = function() {
            const barbershopName = document.getElementById('adminBarbershopName').value;
            const phone = document.getElementById('adminPhone').value;
            const email = document.getElementById('adminEmail').value;
            const address = document.getElementById('adminAddress').value;
            const workingHours = document.getElementById('adminWorkingHours').value;
            const logo = document.getElementById('adminBarbershopLogo').value;
            const ownerPhoto = document.getElementById('adminOwnerPhoto').value;
            const description = document.getElementById('adminDescription').value;
            
            if (barbershopName) settings.barbershopName = barbershopName;
            if (phone) settings.phone = phone;
            if (email) settings.email = email;
            if (address) settings.address = address;
            if (workingHours) settings.workingHours = workingHours;
            if (logo) settings.logo = logo;
            if (ownerPhoto) settings.ownerPhoto = ownerPhoto;
            if (description) settings.description = description;
            
            // Salvar no localStorage
            saveToStorage('settings', settings);
            
            loadSettings();
            showToast('Configura√ß√µes salvas com sucesso!');
        }

        window.changeAdminPassword = function() {
            const newPassword = document.getElementById('newAdminPassword').value;
            const confirmPassword = document.getElementById('confirmAdminPassword').value;
            
            if (!newPassword || !confirmPassword) {
                showToast('Por favor, preencha ambos os campos de senha.', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showToast('As senhas n√£o coincidem. Tente novamente.', 'error');
                return;
            }
            
            if (newPassword.length < 6) {
                showToast('A senha deve ter pelo menos 6 caracteres.', 'error');
                return;
            }
            
            adminCredentials.password = newPassword;
            
            // Salvar no localStorage
            saveToStorage('adminCredentials', adminCredentials);
            
            // Clear form
            document.getElementById('newAdminPassword').value = '';
            document.getElementById('confirmAdminPassword').value = '';
            
            showToast('Senha alterada com sucesso!');
        }

        // ===== FUN√á√ïES INTERNAS (N√ÉO PRECISAM SER GLOBAIS) =====

        function handleAdminLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            const errorDiv = document.getElementById('loginError');
            
            if (username === adminCredentials.username && password === adminCredentials.password) {
                isAdminLoggedIn = true;
                updateAdminUI();
                showPage('admin');
                
                // Clear form
                document.getElementById('adminLoginForm').reset();
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.classList.remove('hidden');
                // Clear password field
                document.getElementById('adminPassword').value = '';
            }
        }

        function updateAdminUI() {
            const logoutBtn = document.getElementById('logoutBtn');
            const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
            
            if (isAdminLoggedIn) {
                logoutBtn.classList.remove('hidden');
                mobileLogoutBtn.classList.remove('hidden');
            } else {
                logoutBtn.classList.add('hidden');
                mobileLogoutBtn.classList.add('hidden');
            }
        }

        // Mobile menu functions
        window.toggleMobileMenu = function() {
            const mobileMenu = document.getElementById('mobileMenu');
            const hamburgerIcon = document.getElementById('hamburgerIcon');
            const closeIcon = document.getElementById('closeIcon');
            
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                hamburgerIcon.classList.add('hidden');
                closeIcon.classList.remove('hidden');
            } else {
                closeMobileMenu();
            }
        }

        window.closeMobileMenu = function() {
            const mobileMenu = document.getElementById('mobileMenu');
            const hamburgerIcon = document.getElementById('hamburgerIcon');
            const closeIcon = document.getElementById('closeIcon');
            
            mobileMenu.classList.add('hidden');
            hamburgerIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
        }

        function toggleCart() {
            const panel = document.getElementById('cartPanel');
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                panel.classList.add('cart-slide-in');
            } else {
                closeCart();
            }
        }

        function closeCart() {
            document.getElementById('cartPanel').classList.add('hidden');
        }

        function updateCartDisplay() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const proceedBtn = document.getElementById('proceedBooking');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Update cart count
            if (totalItems > 0) {
                cartCount.textContent = totalItems;
                cartCount.classList.remove('hidden');
            } else {
                cartCount.classList.add('hidden');
            }
            
            // Update cart items
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-gray-500 text-center">Carrinho vazio</p>';
                proceedBtn.disabled = true;
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="flex justify-between items-center py-2 border-b border-gray-100">
                        <div class="flex-1">
                            <h4 class="font-medium">${item.name}</h4>
                            <p class="text-sm text-gray-600">R$ ${item.price.toFixed(2)} x ${item.quantity}</p>
                        </div>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700 ml-2" title="Remover do carrinho" aria-label="Remover ${item.name} do carrinho">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                `).join('');
                proceedBtn.disabled = false;
            }
            
            // Update total
            cartTotal.textContent = `R$ ${totalPrice.toFixed(2)}`;
        }

        function proceedToBooking() {
            if (cart.length === 0) return;
            closeCart();
            showPage('booking');
        }

        // Services rendering
        function renderServices() {
            const grid = document.getElementById('servicesGrid');
            grid.innerHTML = services.map(service => `
                <div class="service-card bg-white/10 backdrop-blur-sm rounded-2xl p-6 text-center hover:bg-white/20 transition-all duration-300 ${!service.available ? 'opacity-60' : ''}">
                    <h4 class="text-xl font-bold mb-2 text-amber-400">${service.name}</h4>
                    <p class="text-gray-300 mb-2">${service.description}</p>
                    <p class="text-amber-300 text-sm mb-4">‚è±Ô∏è ${service.duration} minutos</p>
                    ${!service.available ? '<p class="text-red-400 text-sm mb-2 font-medium">‚ùå Indispon√≠vel</p>' : ''}
                    <div class="flex justify-between items-center">
                        <span class="text-2xl font-bold text-white">R$ ${service.price.toFixed(2)}</span>
                        <button onclick="addToCart(${service.id})" 
                                class="px-4 py-2 rounded-lg font-medium transition-colors ${
                                    service.available 
                                        ? 'bg-amber-500 hover:bg-amber-600 text-white' 
                                        : 'bg-gray-500 cursor-not-allowed text-gray-300'
                                }" 
                                ${!service.available ? 'disabled' : ''}>
                            ${service.available ? 'Adicionar' : 'Indispon√≠vel'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Week view management
        let currentWeekStart = new Date();
        
        function getWeekStart(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day;
            return new Date(d.setDate(diff));
        }
        
        function renderWeekView() {
            const today = new Date();
            currentWeekStart = getWeekStart(today);
            updateWeekDisplay();
        }
        
        function navigateWeek(direction) {
            currentWeekStart.setDate(currentWeekStart.getDate() + (direction * 7));
            updateWeekDisplay();
        }
        
        function updateWeekDisplay() {
            const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            const weekDaysContainer = document.getElementById('weekDays');
            const weekTitle = document.getElementById('weekTitle');
            const today = new Date();
            
            // Update week title
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(weekEnd.getDate() + 6);
            
            const startMonth = currentWeekStart.toLocaleDateString('pt-BR', { month: 'short' });
            const endMonth = weekEnd.toLocaleDateString('pt-BR', { month: 'short' });
            const year = currentWeekStart.getFullYear();
            
            if (startMonth === endMonth) {
                weekTitle.textContent = `${startMonth} ${year}`;
            } else {
                weekTitle.textContent = `${startMonth} - ${endMonth} ${year}`;
            }
            
            // Create week days
            let weekHTML = '';
            
            // Add day headers
            weekDays.forEach(day => {
                weekHTML += `<div class="text-center text-xs sm:text-sm font-medium text-gray-300 py-2">${day}</div>`;
            });
            
            // Add day buttons
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(currentWeekStart);
                currentDate.setDate(currentDate.getDate() + i);
                
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayNum = currentDate.getDate();
                const monthName = currentDate.toLocaleDateString('pt-BR', { month: 'short' });
                const isToday = currentDate.toDateString() === today.toDateString();
                const isPast = currentDate < today && !isToday;
                const isSunday = currentDate.getDay() === 0; // Domingo = 0
                
                // Verificar se h√° hor√°rios configurados para este dia
                const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                const dayName = dayNames[currentDate.getDay()];
                const dayConfig = weeklySchedule[dayName];
                const hasSchedule = dayConfig && dayConfig.enabled;
                
                // Verificar se √© um dia dispon√≠vel
                const isAvailable = !isPast && hasSchedule;
                
                if (isAvailable) {
                    weekHTML += `
                        <button type="button" onclick="selectDate('${dateStr}')" 
                                class="date-btn h-14 sm:h-20 w-full flex flex-col items-center justify-center text-center rounded-lg sm:rounded-xl border-2 border-white/20 hover:border-amber-400 hover:bg-amber-400/20 text-white transition-all duration-300 transform hover:scale-105 ${isToday ? 'bg-amber-400/30 border-amber-400' : ''}">
                            <span class="font-bold text-lg sm:text-2xl">${dayNum}</span>
                            <span class="text-xs sm:text-sm text-gray-300 mt-0.5 sm:mt-1">${monthName}</span>
                            ${isToday ? '<span class="text-xs text-amber-300">Hoje</span>' : ''}
                        </button>
                    `;
                } else {
                    // Mostrar como indispon√≠vel
                    let reason = 'Indispon√≠vel';
                    if (isPast) reason = 'Passado';
                    else if (!hasSchedule) reason = 'Fechado';
                    
                    weekHTML += `
                        <div class="h-14 sm:h-20 w-full flex flex-col items-center justify-center text-center text-gray-500 cursor-not-allowed rounded-lg sm:rounded-xl bg-gray-800/30 border border-gray-700/50">
                            <span class="font-bold text-lg sm:text-2xl opacity-50">${dayNum}</span>
                            <span class="text-xs sm:text-sm opacity-50 mt-0.5 sm:mt-1">${monthName}</span>
                            <span class="text-xs opacity-70 text-red-400">${reason}</span>
                        </div>
                    `;
                }
            }
            
            weekDaysContainer.innerHTML = weekHTML;
        }
        
        let selectedDateValue = null;
        let selectedTime = null;

        function loadTimeSlots() {
            const selectedDate = selectedDateValue;
            const timeSlotsContainer = document.getElementById('timeSlots');
            
            console.log('Carregando hor√°rios para:', selectedDate);
            console.log('Hor√°rios dispon√≠veis:', schedules);
            
            if (!selectedDate) {
                timeSlotsContainer.innerHTML = '<p class="col-span-3 text-center text-gray-400">Selecione uma data primeiro</p>';
                return;
            }
            
            const availableSchedules = schedules.filter(schedule => schedule.date === selectedDate);
            console.log('Hor√°rios filtrados para a data:', availableSchedules);
            
            if (availableSchedules.length === 0) {
                timeSlotsContainer.innerHTML = '<p class="col-span-3 text-center text-gray-400">Nenhum hor√°rio dispon√≠vel para esta data</p>';
                return;
            }
            
            const today = new Date();
            const isToday = selectedDate === today.toISOString().split('T')[0];
            const currentHour = today.getHours();
            const currentMinutes = today.getMinutes();
            
            const timeSlots = [];
            availableSchedules.forEach(schedule => {
                let start = new Date(`2000-01-01T${schedule.startTime}`);
                const end = new Date(`2000-01-01T${schedule.endTime}`);
                
                // Se for hoje e ainda n√£o passou das 14:00, come√ßar √†s 14:00
                if (isToday) {
                    const now = new Date();
                    const currentTime = now.getHours() * 60 + now.getMinutes();
                    const fourteenHours = 14 * 60; // 14:00 em minutos
                    
                    if (currentTime < fourteenHours) {
                        // Se ainda n√£o s√£o 14:00, come√ßar √†s 14:00
                        start = new Date(`2000-01-01T14:00`);
                    } else {
                        // Se j√° passou das 14:00, come√ßar do pr√≥ximo hor√°rio dispon√≠vel
                        const nextSlot = Math.ceil(currentTime / 30) * 30;
                        const nextHour = Math.floor(nextSlot / 60);
                        const nextMinute = nextSlot % 60;
                        start = new Date(`2000-01-01T${nextHour.toString().padStart(2, '0')}:${nextMinute.toString().padStart(2, '0')}`);
                    }
                }
                
                while (start < end) {
                    const timeStr = start.toTimeString().slice(0, 5);
                    const [hours, minutes] = timeStr.split(':').map(Number);
                    
                    // Verificar se o hor√°rio j√° passou (apenas para hoje)
                    let isPastTime = false;
                    if (isToday) {
                        const slotTime = hours * 60 + minutes;
                        const currentTime = currentHour * 60 + currentMinutes;
                        isPastTime = slotTime <= currentTime;
                    }
                    
                    const isBooked = bookings.some(booking => 
                        booking.date === selectedDate && booking.time === timeStr && !booking.cancelled
                    );
                    
                    // S√≥ adicionar se n√£o for hor√°rio passado
                    if (!isPastTime) {
                        timeSlots.push({
                            time: timeStr,
                            available: !isBooked
                        });
                    }
                    
                    start.setMinutes(start.getMinutes() + 30);
                }
            });
            
            console.log('Hor√°rios gerados:', timeSlots);
            
            if (timeSlots.length === 0) {
                const message = isToday ? 
                    'Hor√°rios dispon√≠veis a partir das 14:00. Nenhum hor√°rio dispon√≠vel para hoje.' :
                    'Nenhum hor√°rio dispon√≠vel para esta data';
                timeSlotsContainer.innerHTML = `<p class="col-span-3 text-center text-gray-400">${message}</p>`;
                return;
            }
            
            timeSlotsContainer.innerHTML = timeSlots.map(slot => `
                <button type="button" onclick="selectTimeSlot('${slot.time}')" 
                        class="time-slot p-3 rounded-lg border-2 transition-all text-center ${
                            slot.available 
                                ? 'border-white/30 hover:border-amber-400 hover:bg-amber-400/20 text-white cursor-pointer' 
                                : 'border-red-500/50 bg-red-500/20 text-red-300 cursor-not-allowed'
                        }" ${!slot.available ? 'disabled' : ''}>
                    <div class="font-medium">${slot.time}</div>
                    ${!slot.available ? '<div class="text-xs mt-1">Ocupado</div>' : '<div class="text-xs mt-1 text-green-400">Dispon√≠vel</div>'}
                </button>
            `).join('');
        }

        function handleBooking(e) {
            e.preventDefault();
            
            const clientName = document.getElementById('clientName').value;
            const clientEmail = document.getElementById('clientEmail').value;
            const selectedDate = selectedDateValue;
            
            if (!selectedDate) {
                showToast('Por favor, selecione uma data.', 'error');
                return;
            }
            
            if (!selectedTime) {
                showToast('Por favor, selecione um hor√°rio.', 'error');
                return;
            }
            
            if (cart.length === 0) {
                showToast('Por favor, adicione servi√ßos ao carrinho antes de agendar.', 'error');
                return;
            }
            
            // Add booking
            const booking = {
                id: Date.now(),
                clientName,
                clientEmail,
                date: selectedDate,
                time: selectedTime,
                services: [...cart],
                completed: false // Inicialmente n√£o conclu√≠do
            };
            
            bookings.push(booking);
            
            // Salvar no localStorage
            saveToStorage('bookings', bookings);
            
            // Send to WhatsApp
            sendToWhatsApp(booking);
            
            // Clear form and cart
            document.getElementById('bookingForm').reset();
            cart = [];
            updateCartDisplay();
            selectedTime = null;
            selectedDateValue = null;
            
            // Reset date selection visual
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.remove('bg-amber-400', 'border-amber-400');
                btn.classList.add('border-white/20');
            });
            
            // Clear time slots
            document.getElementById('timeSlots').innerHTML = '';
            
            // Update bookings display and reports
            renderBookings();
            updateReports();
            
            showToast('Agendamento realizado com sucesso! Redirecionando para WhatsApp...');
        }

        function sendToWhatsApp(booking) {
            // Usa o n√∫mero configurado no admin (settings.phone)
            const phone = settings.phone.replace(/\D/g, '');
            const services = booking.services.map(s => `${s.name} (${s.quantity}x) - R$ ${(s.price * s.quantity).toFixed(2)}`).join('\n');
            const total = booking.services.reduce((sum, s) => sum + (s.price * s.quantity), 0);
            const date = new Date(booking.date).toLocaleDateString('pt-BR');
            
            const message = `üóìÔ∏è *NOVO AGENDAMENTO*\n\n` +
                `üë§ *Cliente:* ${booking.clientName}\n` +
                `üìß *Email:* ${booking.clientEmail}\n` +
                `üìÖ *Data:* ${date}\n` +
                `üïê *Hor√°rio:* ${booking.time}\n\n` +
                `‚úÇÔ∏è *Servi√ßos:*\n${services}\n\n` +
                `üí∞ *Total:* R$ ${total.toFixed(2)}`;
            
            // Envia automaticamente para o n√∫mero configurado no painel admin
            const whatsappUrl = `https://wa.me/55${phone}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // ===== RELAT√ìRIOS FINANCEIROS =====

        // Fun√ß√£o para atualizar relat√≥rios
        function updateReports() {
            const completedBookings = bookings.filter(b => b.completed);
            
            // Calcular m√©tricas
            const totalRevenue = completedBookings.reduce((sum, booking) => {
                return sum + booking.services.reduce((serviceSum, service) => {
                    return serviceSum + (service.price * service.quantity);
                }, 0);
            }, 0);
            
            const totalBookingsCount = completedBookings.length;
            const averageTicket = totalBookingsCount > 0 ? totalRevenue / totalBookingsCount : 0;
            
            // Receita do m√™s atual
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyRevenue = completedBookings
                .filter(booking => {
                    const bookingDate = new Date(booking.date);
                    return bookingDate.getMonth() === currentMonth && bookingDate.getFullYear() === currentYear;
                })
                .reduce((sum, booking) => {
                    return sum + booking.services.reduce((serviceSum, service) => {
                        return serviceSum + (service.price * service.quantity);
                    }, 0);
                }, 0);
            
            // Atualizar cards
            document.getElementById('totalRevenue').textContent = `R$ ${totalRevenue.toFixed(2)}`;
            document.getElementById('totalBookings').textContent = totalBookingsCount;
            document.getElementById('averageTicket').textContent = `R$ ${averageTicket.toFixed(2)}`;
            document.getElementById('monthlyRevenue').textContent = `R$ ${monthlyRevenue.toFixed(2)}`;
            
            // Atualizar gr√°ficos
            updateMonthlyChart(completedBookings);
            updateServicesChart(completedBookings);
        }

        // Fun√ß√£o para atualizar gr√°fico mensal
        function updateMonthlyChart(completedBookings) {
            const monthlyData = {};
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            
            // Inicializar todos os meses com 0
            months.forEach((month, index) => {
                monthlyData[index] = 0;
            });
            
            // Calcular receita por m√™s
            completedBookings.forEach(booking => {
                const bookingDate = new Date(booking.date);
                const month = bookingDate.getMonth();
                const revenue = booking.services.reduce((sum, service) => {
                    return sum + (service.price * service.quantity);
                }, 0);
                monthlyData[month] += revenue;
            });
            
            // Encontrar valor m√°ximo para escala
            const maxValue = Math.max(...Object.values(monthlyData));
            const chartContainer = document.getElementById('monthlyChart');
            
            if (maxValue === 0) {
                chartContainer.innerHTML = '<p class="text-gray-400 text-center">Nenhum dado dispon√≠vel</p>';
                return;
            }
            
            // Gerar barras do gr√°fico
            let chartHTML = '';
            months.forEach((month, index) => {
                const value = monthlyData[index];
                const height = maxValue > 0 ? (value / maxValue) * 200 : 0;
                
                chartHTML += `
                    <div class="flex flex-col items-center">
                        <div class="bg-amber-500 rounded-t" style="height: ${height}px; width: 24px; min-height: ${value > 0 ? '4px' : '0'}"></div>
                        <span class="text-xs mt-2 text-gray-300">${month}</span>
                        <span class="text-xs text-amber-400">R$ ${value.toFixed(0)}</span>
                    </div>
                `;
            });
            
            chartContainer.innerHTML = chartHTML;
        }

        // Fun√ß√£o para atualizar gr√°fico de servi√ßos
        function updateServicesChart(completedBookings) {
            const servicesData = {};
            
            // Contar servi√ßos
            completedBookings.forEach(booking => {
                booking.services.forEach(service => {
                    if (servicesData[service.name]) {
                        servicesData[service.name] += service.quantity;
                    } else {
                        servicesData[service.name] = service.quantity;
                    }
                });
            });
            
            // Ordenar por popularidade
            const sortedServices = Object.entries(servicesData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5); // Top 5
            
            const chartContainer = document.getElementById('servicesChart');
            
            if (sortedServices.length === 0) {
                chartContainer.innerHTML = '<p class="text-gray-400 text-center">Nenhum dado dispon√≠vel</p>';
                return;
            }
            
            const maxValue = Math.max(...sortedServices.map(([,count]) => count));
            
            let chartHTML = '';
            sortedServices.forEach(([serviceName, count], index) => {
                const percentage = maxValue > 0 ? (count / maxValue) * 100 : 0;
                const colors = ['bg-amber-500', 'bg-blue-500', 'bg-green-500', 'bg-purple-500', 'bg-red-500'];
                
                chartHTML += `
                    <div class="flex items-center space-x-3">
                        <div class="flex-1">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">${serviceName}</span>
                                <span class="text-sm text-gray-400">${count}x</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2">
                                <div class="${colors[index]} h-2 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            chartContainer.innerHTML = chartHTML;
        }

        // Fun√ß√µes de exporta√ß√£o e gera√ß√£o de dados
        window.generateSampleData = function() {
            const sampleBookings = [
                {
                    id: Date.now() + 1,
                    clientName: 'Jo√£o Silva',
                    clientEmail: 'joao@email.com',
                    date: '2024-01-15',
                    time: '14:00',
                    services: [{ name: 'Corte Tradicional', price: 25, quantity: 1 }],
                    completed: true
                },
                {
                    id: Date.now() + 2,
                    clientName: 'Pedro Santos',
                    clientEmail: 'pedro@email.com',
                    date: '2024-01-20',
                    time: '15:30',
                    services: [{ name: 'Corte + Barba', price: 40, quantity: 1 }],
                    completed: true
                },
                {
                    id: Date.now() + 3,
                    clientName: 'Carlos Lima',
                    clientEmail: 'carlos@email.com',
                    date: '2024-02-10',
                    time: '16:00',
                    services: [{ name: 'Barba Completa', price: 20, quantity: 1 }],
                    completed: true
                },
                {
                    id: Date.now() + 4,
                    clientName: 'Roberto Costa',
                    clientEmail: 'roberto@email.com',
                    date: '2024-02-25',
                    time: '14:30',
                    services: [{ name: 'Corte Tradicional', price: 25, quantity: 1 }, { name: 'Sobrancelha', price: 15, quantity: 1 }],
                    completed: true
                },
                {
                    id: Date.now() + 5,
                    clientName: 'Andr√© Oliveira',
                    clientEmail: 'andre@email.com',
                    date: '2024-03-05',
                    time: '15:00',
                    services: [{ name: 'Lavagem + Hidrata√ß√£o', price: 30, quantity: 1 }],
                    completed: true
                }
            ];
            
            // Adicionar aos agendamentos existentes
            bookings.push(...sampleBookings);
            saveToStorage('bookings', bookings);
            
            // Atualizar displays
            renderBookings();
            updateReports();
            
            showToast('Dados de exemplo gerados com sucesso!');
        }

        window.exportToCSV = function() {
            const completedBookings = bookings.filter(b => b.completed);
            
            if (completedBookings.length === 0) {
                showToast('Nenhum agendamento conclu√≠do para exportar.', 'error');
                return;
            }
            
            let csvContent = 'Data,Cliente,Email,Hor√°rio,Servi√ßos,Total\n';
            
            completedBookings.forEach(booking => {
                const date = new Date(booking.date).toLocaleDateString('pt-BR');
                const services = booking.services.map(s => `${s.name} (${s.quantity}x)`).join('; ');
                const total = booking.services.reduce((sum, s) => sum + (s.price * s.quantity), 0);
                
                csvContent += `${date},"${booking.clientName}","${booking.clientEmail}",${booking.time},"${services}",R$ ${total.toFixed(2)}\n`;
            });
            
            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `relatorio_barbearia_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Relat√≥rio CSV exportado com sucesso!');
        }

        window.exportToPDF = function() {
            const completedBookings = bookings.filter(b => b.completed);
            
            if (completedBookings.length === 0) {
                showToast('Nenhum agendamento conclu√≠do para exportar.', 'error');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // T√≠tulo
            doc.setFontSize(20);
            doc.text('Relat√≥rio Financeiro - Barbearia', 20, 20);
            
            // Data do relat√≥rio
            doc.setFontSize(12);
            doc.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`, 20, 35);
            
            // M√©tricas
            const totalRevenue = completedBookings.reduce((sum, booking) => {
                return sum + booking.services.reduce((serviceSum, service) => {
                    return serviceSum + (service.price * service.quantity);
                }, 0);
            }, 0);
            
            doc.text(`Total de Agendamentos: ${completedBookings.length}`, 20, 50);
            doc.text(`Receita Total: R$ ${totalRevenue.toFixed(2)}`, 20, 60);
            doc.text(`Ticket M√©dio: R$ ${(totalRevenue / completedBookings.length).toFixed(2)}`, 20, 70);
            
            // Lista de agendamentos
            doc.text('Agendamentos Conclu√≠dos:', 20, 90);
            
            let yPosition = 105;
            completedBookings.forEach((booking, index) => {
                if (yPosition > 270) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                const date = new Date(booking.date).toLocaleDateString('pt-BR');
                const services = booking.services.map(s => `${s.name} (${s.quantity}x)`).join(', ');
                const total = booking.services.reduce((sum, s) => sum + (s.price * s.quantity), 0);
                
                doc.setFontSize(10);
                doc.text(`${index + 1}. ${date} - ${booking.clientName}`, 25, yPosition);
                doc.text(`   Servi√ßos: ${services}`, 25, yPosition + 8);
                doc.text(`   Total: R$ ${total.toFixed(2)}`, 25, yPosition + 16);
                
                yPosition += 25;
            });
            
            // Download PDF
            doc.save(`relatorio_barbearia_${new Date().toISOString().split('T')[0]}.pdf`);
            
            showToast('Relat√≥rio PDF exportado com sucesso!');
        }

        window.clearReportsData = function() {
            if (confirm('Tem certeza que deseja limpar todos os dados de relat√≥rios? Esta a√ß√£o n√£o pode ser desfeita.')) {
                // Manter apenas agendamentos n√£o conclu√≠dos
                bookings = bookings.filter(b => !b.completed);
                saveToStorage('bookings', bookings);
                
                renderBookings();
                updateReports();
                
                showToast('Dados de relat√≥rios limpos com sucesso!');
            }
        }

        // Service management variables
        let editingServiceId = null;

        // Service management functions
        window.showAddServiceForm = function() {
            editingServiceId = null;
            document.getElementById('serviceFormTitle').textContent = 'Adicionar Novo Servi√ßo';
            document.getElementById('serviceName').value = '';
            document.getElementById('servicePrice').value = '';
            document.getElementById('serviceDuration').value = '30';
            document.getElementById('serviceDescription').value = '';
            document.getElementById('serviceForm').classList.remove('hidden');
            
            // Rolar suavemente at√© o formul√°rio
            setTimeout(() => {
                document.getElementById('serviceForm').scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }, 100);
        }

        window.editService = function(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (!service) return;
            
            editingServiceId = serviceId;
            document.getElementById('serviceFormTitle').textContent = 'Editar Servi√ßo';
            document.getElementById('serviceName').value = service.name;
            document.getElementById('servicePrice').value = service.price;
            document.getElementById('serviceDuration').value = service.duration;
            document.getElementById('serviceDescription').value = service.description;
            document.getElementById('serviceForm').classList.remove('hidden');
            
            // Rolar suavemente at√© o formul√°rio
            setTimeout(() => {
                document.getElementById('serviceForm').scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }, 100);
        }

        window.saveService = function() {
            const name = document.getElementById('serviceName').value.trim();
            const price = parseFloat(document.getElementById('servicePrice').value);
            const duration = parseInt(document.getElementById('serviceDuration').value);
            const description = document.getElementById('serviceDescription').value.trim();
            
            if (!name || !price || !duration) {
                showToast('Por favor, preencha todos os campos obrigat√≥rios.', 'error');
                return;
            }
            
            if (price <= 0) {
                showToast('O pre√ßo deve ser maior que zero.', 'error');
                return;
            }
            
            if (editingServiceId) {
                // Editando servi√ßo existente
                const service = services.find(s => s.id === editingServiceId);
                if (service) {
                    service.name = name;
                    service.price = price;
                    service.duration = duration;
                    service.description = description;
                    showToast('Servi√ßo atualizado com sucesso!');
                }
            } else {
                // Adicionando novo servi√ßo
                const newService = {
                    id: Date.now(),
                    name,
                    price,
                    duration,
                    description,
                    available: true
                };
                services.push(newService);
                showToast('Servi√ßo adicionado com sucesso!');
            }
            
            saveToStorage('services', services);
            renderServices();
            renderServicesList();
            cancelServiceForm();
        }

        window.cancelServiceForm = function() {
            document.getElementById('serviceForm').classList.add('hidden');
            editingServiceId = null;
        }

        window.deleteService = function(serviceId) {
            if (confirm('Tem certeza que deseja excluir este servi√ßo?')) {
                services = services.filter(s => s.id !== serviceId);
                saveToStorage('services', services);
                renderServices();
                renderServicesList();
                showToast('Servi√ßo exclu√≠do com sucesso!');
            }
        }

        function renderServicesList() {
            const container = document.getElementById('servicesList');
            
            if (services.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center">Nenhum servi√ßo cadastrado</p>';
                return;
            }
            
            container.innerHTML = services.map(service => `
                <div class="bg-white/5 p-4 rounded-lg border border-white/20 flex justify-between items-center">
                    <div class="flex-1">
                        <div class="flex items-center space-x-3 mb-2">
                            <h4 class="font-semibold text-lg">${service.name}</h4>
                            <span class="px-2 py-1 rounded-full text-xs ${service.available ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}">
                                ${service.available ? 'Dispon√≠vel' : 'Indispon√≠vel'}
                            </span>
                        </div>
                        <p class="text-gray-300 text-sm mb-2">${service.description}</p>
                        <div class="flex items-center space-x-4 text-sm">
                            <span class="text-amber-400 font-medium">R$ ${service.price.toFixed(2)}</span>
                            <span class="text-gray-400">‚è±Ô∏è ${service.duration} min</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="toggleServiceAvailability(${service.id})" 
                                class="px-3 py-1 rounded text-sm font-medium transition-colors ${service.available ? 'bg-red-500/20 text-red-400 hover:bg-red-500/30' : 'bg-green-500/20 text-green-400 hover:bg-green-500/30'}" 
                                title="${service.available ? 'Tornar indispon√≠vel' : 'Tornar dispon√≠vel'}">
                            ${service.available ? '‚ùå' : '‚úÖ'}
                        </button>
                        <button onclick="editService(${service.id})" 
                                class="px-3 py-1 bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 rounded text-sm font-medium transition-colors" 
                                title="Editar servi√ßo">
                            ‚úèÔ∏è
                        </button>
                        <button onclick="deleteService(${service.id})" 
                                class="px-3 py-1 bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded text-sm font-medium transition-colors" 
                                title="Excluir servi√ßo">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Fun√ß√µes de gerenciamento de agendamentos
        function renderBookings(filter = 'all') {
            const container = document.getElementById('bookingsContainer');
            let filteredBookings = bookings;
            
            if (filter === 'pending') {
                filteredBookings = bookings.filter(b => !b.completed && !b.cancelled);
            } else if (filter === 'completed') {
                filteredBookings = bookings.filter(b => b.completed);
            }
            
            // Ordenar por data e hor√°rio (mais recentes primeiro)
            filteredBookings.sort((a, b) => {
                const dateA = new Date(`${a.date}T${a.time}`);
                const dateB = new Date(`${b.date}T${b.time}`);
                return dateB - dateA;
            });
            
            // Atualizar contadores
            const pendingCount = bookings.filter(b => !b.completed && !b.cancelled).length;
            const completedCount = bookings.filter(b => b.completed).length;
            
            document.getElementById('pendingCount').textContent = pendingCount;
            document.getElementById('completedCount').textContent = completedCount;
            
            if (filteredBookings.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">Nenhum agendamento encontrado</p>';
                return;
            }
            
            container.innerHTML = filteredBookings.map(booking => {
                const date = new Date(booking.date).toLocaleDateString('pt-BR');
                const services = booking.services.map(s => `${s.name} (${s.quantity}x)`).join(', ');
                const total = booking.services.reduce((sum, s) => sum + (s.price * s.quantity), 0);
                
                let statusBadge = '';
                let actionButtons = '';
                
                if (booking.cancelled) {
                    statusBadge = '<span class="px-2 py-1 bg-red-500/20 text-red-400 rounded-full text-xs">Cancelado</span>';
                } else if (booking.completed) {
                    statusBadge = '<span class="px-2 py-1 bg-green-500/20 text-green-400 rounded-full text-xs">Conclu√≠do</span>';
                    actionButtons = `
                        <button onclick="uncompleteBooking(${booking.id})" 
                                class="px-3 py-1 bg-amber-500/20 text-amber-400 hover:bg-amber-500/30 rounded text-sm transition-colors" 
                                title="Marcar como pendente">
                            ‚Ü©Ô∏è Reabrir
                        </button>
                    `;
                } else {
                    statusBadge = '<span class="px-2 py-1 bg-amber-500/20 text-amber-400 rounded-full text-xs">Pendente</span>';
                    actionButtons = `
                        <button onclick="completeBooking(${booking.id})" 
                                class="px-3 py-1 bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded text-sm transition-colors" 
                                title="Marcar como conclu√≠do">
                            ‚úÖ Concluir
                        </button>
                        <button onclick="cancelBooking(${booking.id})" 
                                class="px-3 py-1 bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded text-sm transition-colors" 
                                title="Cancelar agendamento">
                            ‚ùå Cancelar
                        </button>
                    `;
                }
                
                return `
                    <div class="bg-white/5 p-4 rounded-lg border border-white/20">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <div class="flex items-center space-x-3 mb-2">
                                    <h4 class="font-semibold text-lg">${booking.clientName}</h4>
                                    ${statusBadge}
                                </div>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-gray-300">
                                    <p>üìß ${booking.clientEmail}</p>
                                    <p>üìÖ ${date} √†s ${booking.time}</p>
                                </div>
                                <p class="text-sm text-gray-300 mt-2">‚úÇÔ∏è ${services}</p>
                                <p class="text-amber-400 font-semibold mt-2">üí∞ Total: R$ ${total.toFixed(2)}</p>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-2 pt-3 border-t border-white/10">
                            ${actionButtons}
                            <button onclick="deleteBooking(${booking.id})" 
                                    class="px-3 py-1 bg-gray-500/20 text-gray-400 hover:bg-gray-500/30 rounded text-sm transition-colors" 
                                    title="Excluir agendamento">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        window.showPendingBookings = function() {
            renderBookings('pending');
        }

        window.showCompletedBookings = function() {
            renderBookings('completed');
        }

        window.showAllBookings = function() {
            renderBookings('all');
        }

        window.completeBooking = function(bookingId) {
            const booking = bookings.find(b => b.id === bookingId);
            if (booking) {
                booking.completed = true;
                booking.cancelled = false;
                saveToStorage('bookings', bookings);
                renderBookings();
                updateReports();
                showToast('Agendamento marcado como conclu√≠do!');
            }
        }

        window.uncompleteBooking = function(bookingId) {
            const booking = bookings.find(b => b.id === bookingId);
            if (booking) {
                booking.completed = false;
                saveToStorage('bookings', bookings);
                renderBookings();
                updateReports();
                showToast('Agendamento reaberto!');
            }
        }

        window.cancelBooking = function(bookingId) {
            if (confirm('Tem certeza que deseja cancelar este agendamento?')) {
                const booking = bookings.find(b => b.id === bookingId);
                if (booking) {
                    booking.cancelled = true;
                    booking.completed = false;
                    saveToStorage('bookings', bookings);
                    renderBookings();
                    updateReports();
                    showToast('Agendamento cancelado!');
                }
            }
        }

        window.deleteBooking = function(bookingId) {
            if (confirm('Tem certeza que deseja excluir permanentemente este agendamento?')) {
                bookings = bookings.filter(b => b.id !== bookingId);
                saveToStorage('bookings', bookings);
                renderBookings();
                updateReports();
                showToast('Agendamento exclu√≠do permanentemente!');
            }
        }

        function loadSettings() {
            // Atualizar elementos da p√°gina com as configura√ß√µes salvas
            document.getElementById('barbershopName').textContent = settings.barbershopName;
            document.getElementById('barbershopDescription').textContent = settings.description;
            document.getElementById('contactPhone').textContent = settings.phone;
            document.getElementById('contactEmail').textContent = settings.email;
            document.getElementById('contactAddress').textContent = settings.address;
            document.getElementById('contactWorkingHours').textContent = settings.workingHours;
            
            // Atualizar imagens
            if (settings.logo) {
                document.getElementById('barbershopLogo').src = settings.logo;
            }
            if (settings.ownerPhoto) {
                document.getElementById('ownerPhoto').src = settings.ownerPhoto;
            }
            
            // Preencher campos do admin
            document.getElementById('adminBarbershopName').value = settings.barbershopName;
            document.getElementById('adminPhone').value = settings.phone;
            document.getElementById('adminEmail').value = settings.email;
            document.getElementById('adminAddress').value = settings.address;
            document.getElementById('adminWorkingHours').value = settings.workingHours;
            document.getElementById('adminBarbershopLogo').value = settings.logo;
            document.getElementById('adminOwnerPhoto').value = settings.ownerPhoto;
            document.getElementById('adminDescription').value = settings.description;
        }

    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9814a4e6c3408125',t:'MTc1ODIzODM2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
